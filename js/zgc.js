var zgcw,zgch;let zgcsvg,zgcprojection,zgcland,zgcworld,zgcroadworld,zgcbuildingworld,zgcfoodsvg,zgcfoodworld,zgcfoodSign,zgcfoodtextsvg,zgccountworld;d3.json("data/zgc/zgc.geojson",function(t){zgcw=window.innerWidth,zgch=window.innerHeight,zgcsvg=d3.select("#zgc-container").append("svg").attr("width",zgcw).attr("height",zgch),zgcprojection=d3.geo.mercator().scale(57e4).translate([zgcw/2,zgch/2]).center([116.38,39.96]),zgcland=d3.geo.path().projection(zgcprojection),zgcworld=zgcsvg.selectAll(".out > path").data(t.features).enter().append("path").attr("class","out").attr("d",zgcland).style("stroke-width",1).style("stroke","#000000")}),d3.json("data/zgc/zgcbuilding.geojson",function(t){zgcbuildingworld=zgcsvg.selectAll(".building > path").data(t.features).enter().append("path").attr("class","building").attr("d",zgcland).style("stroke-width",0).style("fill","#2d2d2d")}),d3.json("data/zgc/count.geojson",function(t){zgccountworld=zgcsvg.selectAll(".count > path").data(t.features).enter().append("path").attr("class","count").attr("d",zgcland).style("stroke-width",0).style("opacity",function(t){return .03*t.properties.Count_}).style("fill","#ffffff")}),d3.json("data/zgc/zgcroads.geojson",function(t){zgcroadworld=zgcsvg.selectAll(".road > path").data(t.features).enter().append("path").attr("class","road").style("z-index",20).attr("d",zgcland).style("stroke-width",function(t){return"primary"==t.properties.fclass?1:"secondary"==t.properties.fclass?.7:"tertiary"==t.properties.fclass?.4:.2}).style("stroke","#ffffff")}),d3.json("data/zgc/zgcfood.geojson",function(t){zgcfoodsvg=d3.select("#zgc-food-container").append("svg").attr("width",zgcw).attr("height",zgch/2);var e=function(t){d3.selectAll(".c"+t.typecode).transition().duration(150).attr("r",55),d3.select(this).transition().duration(50).style("fill","#000000")},o=function(t){d3.selectAll(".rest").transition().duration(150).attr("r",.5),d3.select(this).transition().duration(50).style("fill","#ffffff")};zgcfoodworld=zgcfoodsvg.selectAll(".food > circle").data(t.features).enter().append("circle").attr("class",function(t){return"food rest c"+String(t.properties.typecode).slice(0,4)}).style("stroke-width",.2).style("fill","none").style("stroke","#ffffff").attr("r",function(t){return .5}).attr("cx",function(t){return zgcprojection([t.properties.LONWGS84,t.properties.LATWGS84])[0]}).attr("cy",function(t){return zgcprojection([t.properties.LONWGS84,t.properties.LATWGS84])[1]}),zgcfoodSign=zgcfoodsvg.selectAll(".foodc>circle").data([{id:"0",typecode:"0500",name:"Food"},{id:"1",typecode:"0501",name:"Chinese Food"},{id:"2",typecode:"0502",name:"Fast Food"},{id:"3",typecode:"0503",name:"Foreign Food"},{id:"4",typecode:"0505",name:"Coffee"},{id:"5",typecode:"0506",name:"Tea House"},{id:"6",typecode:"0507",name:"Beverage"},{id:"7",typecode:"0508",name:"Pastry"}]).enter().append("circle").attr("class","foodc").style("stroke-width",.2).style("fill","#ffffff").style("stroke","#000000").attr("r",5).attr("cx",function(t){return zgcw/5+70*(t.id-4)}).attr("cy",10).on("mouseover",e).on("mouseleave",o),zgcfoodtextsvg=zgcfoodsvg.selectAll(".foodt>text").data([{id:"0",typecode:"0500",name:"Food"},{id:"1",typecode:"0501",name:"Chinese Food"},{id:"2",typecode:"0502",name:"Fast Food"},{id:"3",typecode:"0503",name:"Foreign Food"},{id:"4",typecode:"0505",name:"Coffee"},{id:"5",typecode:"0506",name:"Tea House"},{id:"6",typecode:"0507",name:"Beverage"},{id:"7",typecode:"0508",name:"Pastry"}]).enter().append("text").attr("class","foodt").attr("fill","#000000").attr("y",30).attr("x",function(t){return zgcw/5+70*(t.id-4)}).style("text-anchor","middle").text(function(t){return t.name})}),window.addEventListener("resize",function(){zgcw=window.innerWidth,zgch=window.innerHeight,zgcsvg.attr("width",zgcw).attr("height",zgch),zgcprojection.translate([w/2,h/2]),zgcland.projection(zgcprojection),zgcfoodworld.attr("d",zgcland),zgccountworld.attr("d",zgcland),zgcbuildingworld.attr("d",zgcland),zgcroadworld.attr("d",zgcland),zgcfoodsvg.attr("width",zgcw).attr("height",zgch/2),zgcfoodtextsvg.attr("x",function(t){return zgcw/5+70*(t.id-4)}),zgcfoodSign.attr("cx",function(t){return zgcw/5+70*(t.id-4)}).attr("cy",10)});