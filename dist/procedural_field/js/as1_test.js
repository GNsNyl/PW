let table,tableArray,backcolPic,colPic,linecolPic,textcolPic,font,bg,w,h,img,fontsize=12,float=.01,inputFile,csv,msg="Drag and drop .csv file into the canvas";function preload(){table=loadTable("data/artists.csv","csv","header")}var slider_size=document.getElementById("myRangeSize"),slider=document.getElementById("myRange"),slider_line=document.getElementById("myRangeLine"),slider_line_weight=document.getElementById("myRangeLineWeight"),slider_text=document.getElementById("myRangeText"),slider_font_size=document.getElementById("myRangeFontSize"),circles=[];let cns;function setup(){clear(),(cns=createCanvas(.6*windowWidth,.7*windowHeight)).parent("drawing-container"),cns.drop(gotFile),textAlign(CENTER,CENTER),strokeWeight(0),(backcolPic=createColorPicker("black")).parent("#circle"),backcolPic.size(25,25),(colPic=createColorPicker("white")).parent("#circle"),colPic.size(25,25),(linecolPic=createColorPicker("white")).parent("#curve"),linecolPic.size(25,25),(textcolPic=createColorPicker("white")).parent("#text"),textcolPic.size(25,25),ellipseMode(RADIUS),tableArray=table.getArray();for(let t=0;t<tableArray.length;t++){let l=tableArray[t][1],i=tableArray[t][3],r=tableArray[t][6],a=tableArray[t][6],c=tableArray[t][4];circles.push({x:.5*windowWidth*(.1+Math.random()),y:.5*windowHeight*Math.random(),color:"#000",breed:l,radius_num:r,arm_num:a,yob:c,gender:i,active:!1})}}function draw(){let t=backcolPic.color(),l=slider.value,i=slider_size.value,r=colPic.color(),a=slider_line.value,c=slider_line_weight.value/10,n=linecolPic.color(),s=slider_text.value,o=textcolPic.color();if(fontsize=Number(slider_font_size.value),console.log(fontsize),background(t),textSize(fontsize),text(msg,width/2,height-25),r.setAlpha(l),n.setAlpha(.01+a*Math.abs(Math.sin(float*Math.PI))),o.setAlpha(s),circles.length>0)for(var d=0;d<circles.length;d++){var $,y,f,u,b,m,v,P,p=circles[d];let _=i*p.yob/200,A=p.arm_num;strokeWeight(c),stroke(n),noFill(),$=p.x,y=p.y-_;let x=[];for(let z=1;z<A+1;z+=1){var I=2*Math.cos(Math.PI*(z+.75)/(.75*A));f=$-39*I*Math.cos(d+float*Math.PI),u=y-1.5*_*Math.abs(Math.sin(d+float*Math.PI)),b=f+10*I,m=u-30,v=b+10*I,P=m-(z/A+.5)*6,bezier((x=[createVector($,y),createVector(f,u),createVector(b,m),createVector(v,P)])[0].x,x[0].y,x[1].x,x[1].y,x[2].x,x[2].y,x[3].x,x[3].y)}fill(o),textSize(fontsize),noStroke(),text(p.breed+" "+p.radius_num,$,y+2*_+10),fill(r),ellipse(p.x,p.y,_,_)}float+=.002}function gotFile(t){if(console.log(t),msg="Parsing file...",csv=parseCSV(inputFile=t),console.log(csv),csv){circles=[],tableArray=table.getArray();for(let l=0;l<tableArray.length;l++){let i=tableArray[l][1],r=tableArray[l][3],a=tableArray[l][6],c=tableArray[l][6],n=tableArray[l][4];circles.push({x:.5*windowWidth*(.1+Math.random()),y:.5*windowHeight*Math.random(),color:"#000",breed:i,radius_num:a,arm_num:c,yob:n,gender:r,active:!1})}}msg=""}function parseCSV(t){let l=[],i=t.data.split("\n");return i.forEach(t=>{l.push(t.split(","))}),l}function mousePressed(){if(mouseX>0&&mouseY>0){if(circles.length>0)for(var t=0;t<circles.length;t++){var l=circles[t];dist(mouseX,mouseY,l.x,l.y)<l.radius_num?l.active=!0:(l.active=!1,l.color=colPic.color())}return!1}}function mouseDragged(){if(mouseX>0&&mouseY>0){if(circles.length>0)for(var t=0;t<circles.length;t++){var l=circles[t];if(l.active){l.x=mouseX,l.y=mouseY;break}}return!1}}function keyPressed(){"s"==key&&save("data-viz.png")}window.onresize=function t(){w=window.innerWidth||e.clientWidth||g.clientWidth,h=window.innerHeight||e.clientHeight||g.clientHeight,cns.resize(w,h)};